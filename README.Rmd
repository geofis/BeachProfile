---
title: "BeachProfile"
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  collapse=TRUE,
  out.width='100%',
  fig.path = "img/"
)
```

## Packages

```{r, warning=F, message=F}
library(tidyverse)
library(purrr)
library(sf)
library(RColorBrewer)
library(raster)
```


## Read the functions

```{r, results='hide'}
funs <- list.files('R', pattern = '*.R', full.names = T)
map(funs, source)
```

## Import/plot transects and shorelines

```{r}
# transprof <- rtrans('data/transect-profiles.geojson')
transprof <- rtrans('data/transect-profiles-short.geojson')
dsm <- raster('data/dsm.tif')
plot(dsm)
plot(as_Spatial(transprof), add=T)

#ggplot of transects
cols <- colorRampPalette(brewer.pal(9,'Set1'))(nrow(transprof))
ggplot() +
  geom_sf(data = transprof, color = cols) +
  scale_color_manual(values = c('black', 'orange', 'blue')) +
  geom_sf_text(
    data = transprof %>%
      st_centroid, aes(label = transect), size = 4) +
  theme_minimal() +
  theme(legend.title = element_blank())
```

## Profiles

```{r}
prof <- profiles(transects = transprof, height = dsm, facetRows = 3, movingAvgK = 10)
prof
```
